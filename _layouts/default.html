<!DOCTYPE html>
<html>

  {% include head.html %}

  <body class="{% if page.body_class %}{{ page.body_class }}{% endif %} {% if page.category %}{{ page.category }}{% endif %} {% if page.collection %}{{ page.collection }}{% endif %} {% unless page.picture %}noheader{% endunless %}" itemscope="itemscope" itemtype="http://schema.org/WebPage">
    {% include header.html %}

    <div id="container">
    {{ content }}
    {% include footer.html %}
    </div>
  {% include modals/_modal_sidebar.html %}
    <!-- Javascript -->

    {% capture js %}{% if site.use_cdn %}{{ site.js_dir | prepend: site.baseurl | prepend: site.cdn }}{% else %}{{ site.js_dir | prepend: site.baseurl }}{% endif %}/application.js{% endcapture %}

    <script src="{{ js }}"></script>
    <script>
        var testTarget;
        (function($) {
            $(document).ready( function() {

                {% comment %}
                //initialises email concealment js
                // disabling until we have emails to conceal
                // AND we can figure out how to access the function without an 'undefined' error
                // $('.e').emailLink();
                {% endcomment %}


                {% comment %}

                The following initialises the by the morphing button.
                 _includes/uiMorphingButton_fixed.js
                 and
                 classie.js.
                 modals.scss

                 We load the required javascript for each of the three by either:
                 include _javascripts/modals/sidebar.js
                 include _javascripts/modals/text.js
                 include _javascripts/modals/overlay.js

                 {% endcomment %}

                //initalise sidebar
                {% include _javascripts/classie.js %}
                {% include _javascripts/uiMorphingButton_fixed.js %}
                {% include _javascripts/modals/sidebar.js %}



                /* jpage start */

                  var pagination = $("#gallery-pagination");

                  function setLazyLoad () {
                  	$('#gallery').find("img").lazyload({
                  		event : "turnPage",
                  		effect : "fadeIn"
                  	});
                  };

                  function setPagination () {
                    pagination.jPages({
                      containerID : "gallery",
                            perPage : 6,
                            direction : "auto",
                            animation : "fadeInUp",
                            callback : function( pages, items ){
                                items.showing.find("img").trigger("turnPage");
                                items.oncoming.find("img").trigger("turnPage");
                            }
                        });
                  };

                  function destroyPagination () {
                    pagination.jPages("destroy");
                  };

                  setLazyLoad();
                  setPagination();

                  $.filtrify("gallery", "tag-filters", {
                    callback : function() {
                            destroyPagination();
                            setPagination();
                    }
                  });

                /* jpage end */


                // initialise WOW.min.js
                // new WOW().init();

                // Gallery item page:
                // output steps hidden by default
                $('.outputs').hide();

                // Toggle visibility of output steps
                $('.outputs-toggle').on('click', function(e){
                  // find associated block from the data-operation-number attribute on the link
                  var targetDivNumber = $(this).data('operation-number');
                  $('.operation-number-'+targetDivNumber).slideToggle();
                  e.preventDefault();
                });

            } );
        })(jQuery);

    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', '{{ site.google_analytics }}', 'popupcad.org');
      ga('send', 'pageview');
    </script>
  </body>
</html>
